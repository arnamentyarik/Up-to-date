{% extends "base.html" %}

{% block title %}Статистика - Elite Squad Bedwars{% endblock %}

{% block content %}
<div class="statistics-page">
    <!-- Header -->
    <div class="stats-header text-center py-4 mb-5">
        <h1 class="display-4 fw-bold text-warning mb-3">
            <i class="fas fa-chart-bar me-3"></i>Статистика сервера
        </h1>
        <p class="lead text-muted">Детальная аналитика Elite Squad Bedwars</p>
    </div>

    <!-- Overall Stats -->
    {% if stats %}
    <div class="overall-stats mb-5">
        <h3 class="section-title mb-4">
            <i class="fas fa-globe text-info me-2"></i>Общая статистика
        </h3>
        <div class="row g-4">
            <div class="col-lg-2 col-md-4 col-6">
                <div class="modern-stat-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="stat-icon-container">
                        <div class="stat-icon-bg"></div>
                        <i class="fas fa-users stat-icon text-primary"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value gradient-text">{{ stats.total_players }}</div>
                        <div class="stat-label">Игроков</div>
                        <div class="stat-change">Всего зарегистрировано</div>
                    </div>
                    <div class="stat-wave"></div>
                </div>
            </div>
            <div class="col-lg-2 col-md-4 col-6">
                <div class="modern-stat-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="stat-icon-container">
                        <div class="stat-icon-bg"></div>
                        <i class="fas fa-sword stat-icon text-danger"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value gradient-text">{{ "{:,}".format(stats.total_kills) }}</div>
                        <div class="stat-label">Убийств</div>
                        <div class="stat-change">Всего совершено</div>
                    </div>
                    <div class="stat-wave"></div>
                </div>
            </div>
            <div class="col-lg-2 col-md-4 col-6">
                <div class="modern-stat-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="stat-icon-container">
                        <div class="stat-icon-bg"></div>
                        <i class="fas fa-skull stat-icon text-secondary"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value gradient-text">{{ "{:,}".format(stats.total_deaths) }}</div>
                        <div class="stat-label">Смертей</div>
                        <div class="stat-change">Общий счет</div>
                    </div>
                    <div class="stat-wave"></div>
                </div>
            </div>
            <div class="col-lg-2 col-md-4 col-6">
                <div class="modern-stat-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="stat-icon-container">
                        <div class="stat-icon-bg"></div>
                        <i class="fas fa-gamepad stat-icon text-success"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value gradient-text">{{ "{:,}".format(stats.total_games) }}</div>
                        <div class="stat-label">Игр</div>
                        <div class="stat-change">Всего сыграно</div>
                    </div>
                    <div class="stat-wave"></div>
                </div>
            </div>
            <div class="col-lg-2 col-md-4 col-6">
                <div class="modern-stat-card" data-aos="fade-up" data-aos-delay="500">
                    <div class="stat-icon-container">
                        <div class="stat-icon-bg"></div>
                        <i class="fas fa-trophy stat-icon text-warning"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value gradient-text">{{ "{:,}".format(stats.total_wins) }}</div>
                        <div class="stat-label">Побед</div>
                        <div class="stat-change">Успешных игр</div>
                    </div>
                    <div class="stat-wave"></div>
                </div>
            </div>
            <div class="col-lg-2 col-md-4 col-6">
                <div class="modern-stat-card" data-aos="fade-up" data-aos-delay="600">
                    <div class="stat-icon-container">
                        <div class="stat-icon-bg"></div>
                        <i class="fas fa-bed stat-icon text-info"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value gradient-text">{{ "{:,}".format(stats.total_beds_broken) }}</div>
                        <div class="stat-label">Кроватей</div>
                        <div class="stat-change">Уничтожено</div>
                    </div>
                    <div class="stat-wave"></div>
                </div>
            </div>
        </div>

        <!-- Economic Statistics -->
        <div class="row g-4 mt-4">
            <div class="col-12">
                <h4 class="section-title mb-4">
                    <i class="fas fa-coins text-warning me-2"></i>Экономическая статистика
                </h4>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="economic-stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-coins text-warning"></i>
                    </div>
                    <div class="stat-value">{{ "{:,}".format(stats.total_coins) }}</div>
                    <div class="stat-label">Всего койнов</div>
                    <div class="stat-progress">
                        <div class="progress-bar" style="width: 100%"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="economic-stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-star text-purple"></i>
                    </div>
                    <div class="stat-value">{{ "{:,}".format(stats.total_reputation) }}</div>
                    <div class="stat-label">Всего репутации</div>
                    <div class="stat-progress">
                        <div class="progress-bar" style="width: 100%"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="economic-stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line text-success"></i>
                    </div>
                    <div class="stat-value">{{ "{:,}".format(stats.average_coins) }}</div>
                    <div class="stat-label">Средние койны</div>
                    <div class="stat-progress">
                        <div class="progress-bar" style="width: 85%"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="economic-stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-medal text-info"></i>
                    </div>
                    <div class="stat-value">{{ "{:,}".format(stats.average_reputation) }}</div>
                    <div class="stat-label">Средняя репутация</div>
                    <div class="stat-progress">
                        <div class="progress-bar" style="width: 75%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Top Economic Players -->
        {% if stats.richest_player or stats.most_reputable_player %}
        <div class="row g-4 mt-4">
            <div class="col-12">
                <h4 class="section-title mb-4">
                    <i class="fas fa-crown text-warning me-2"></i>Экономические лидеры
                </h4>
            </div>
            {% if stats.richest_player %}
            <div class="col-md-6">
                <div class="leader-card richest-leader">
                    <div class="leader-bg"></div>
                    <div class="leader-content">
                        <div class="leader-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h5 class="leader-title">Самый богатый игрок</h5>
                        <div class="leader-name">{{ stats.richest_player.nickname }}</div>
                        <div class="leader-value">{{ "{:,}".format(stats.richest_player.coins) }} койнов</div>
                    </div>
                </div>
            </div>
            {% endif %}
            {% if stats.most_reputable_player %}
            <div class="col-md-6">
                <div class="leader-card reputable-leader">
                    <div class="leader-bg"></div>
                    <div class="leader-content">
                        <div class="leader-icon">
                            <i class="fas fa-gem"></i>
                        </div>
                        <h5 class="leader-title">Самый уважаемый игрок</h5>
                        <div class="leader-name">{{ stats.most_reputable_player.nickname }}</div>
                        <div class="leader-value">{{ "{:,}".format(stats.most_reputable_player.reputation) }} репутации</div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- Charts Section -->
    <div class="charts-section mb-5">
        <h3 class="section-title mb-4">
            <i class="fas fa-chart-line text-success me-2"></i>Графики и аналитика
        </h3>
        <div class="row g-4">
            <!-- Top Players by Experience -->
            <div class="col-md-6">
                <div class="chart-card">
                    <div class="chart-header">
                        <h4 class="chart-title">
                            <i class="fas fa-star text-warning me-2"></i>Топ по опыту
                        </h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="experienceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Top Players by Kills -->
            <div class="col-md-6">
                <div class="chart-card">
                    <div class="chart-header">
                        <h4 class="chart-title">
                            <i class="fas fa-sword text-danger me-2"></i>Топ по убийствам
                        </h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="killsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Level Distribution -->
            <div class="col-md-6">
                <div class="chart-card">
                    <div class="chart-header">
                        <h4 class="chart-title">
                            <i class="fas fa-chart-pie text-success me-2"></i>Распределение уровней
                        </h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="levelsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Performance Comparison -->
            <div class="col-md-6">
                <div class="chart-card">
                    <div class="chart-header">
                        <h4 class="chart-title">
                            <i class="fas fa-chart-area text-info me-2"></i>Сравнение показателей
                        </h4>
                    </div>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Top Players Section -->
    {% if top_players %}
        <!-- Top 3 Players Section -->
        <div class="row mb-5">
            <div class="col-12">
                <h3 class="section-title mb-4 text-center">
                    <i class="fas fa-trophy text-warning me-2"></i>👑 Лучшие игроки 👑
                </h3>
                <p class="text-center text-muted mb-4">Топ-3 игрока по опыту</p>
            </div>
        </div>

        <div class="top-players-podium mb-5">
            {% if top_players|length >= 3 %}
            <!-- 2nd Place -->
            <div class="podium-place podium-second">
                <div class="place-number">2</div>
                <div class="player-avatar">
                    <img src="{{ top_players[1].minecraft_skin_url }}" alt="{{ top_players[1].nickname }}" class="player-skin">
                    <div class="avatar-glow silver-glow"></div>
                </div>
                <h4 class="player-name">{{ top_players[1].nickname }}</h4>
                <div class="player-level">Уровень {{ top_players[1].level }}</div>
                <div class="experience-badge silver">{{ "{:,}".format(top_players[1].experience) }} XP</div>
                <div class="stats-mini">
                    <span><i class="fas fa-sword"></i> {{ top_players[1].kills }}</span>
                    <span><i class="fas fa-trophy"></i> {{ top_players[1].wins }}</span>
                </div>
            </div>

            <!-- 1st Place -->
            <div class="podium-place podium-first">
                <div class="place-number">1</div>
                <div class="crown-icon">👑</div>
                <div class="player-avatar">
                    <img src="{{ top_players[0].minecraft_skin_url }}" alt="{{ top_players[0].nickname }}" class="player-skin">
                    <div class="avatar-glow gold-glow"></div>
                </div>
                <h4 class="player-name">{{ top_players[0].nickname }}</h4>
                <div class="player-level">Уровень {{ top_players[0].level }}</div>
                <div class="experience-badge gold">{{ "{:,}".format(top_players[0].experience) }} XP</div>
                <div class="stats-mini">
                    <span><i class="fas fa-sword"></i> {{ top_players[0].kills }}</span>
                    <span><i class="fas fa-trophy"></i> {{ top_players[0].wins }}</span>
                </div>
            </div>

            <!-- 3rd Place -->
            <div class="podium-place podium-third">
                <div class="place-number">3</div>
                <div class="player-avatar">
                    <img src="{{ top_players[2].minecraft_skin_url }}" alt="{{ top_players[2].nickname }}" class="player-skin">
                    <div class="avatar-glow bronze-glow"></div>
                </div>
                <h4 class="player-name">{{ top_players[2].nickname }}</h4>
                <div class="player-level">Уровень {{ top_players[2].level }}</div>
                <div class="experience-badge bronze">{{ "{:,}".format(top_players[2].experience) }} XP</div>
                <div class="stats-mini">
                    <span><i class="fas fa-sword"></i> {{ top_players[2].kills }}</span>
                    <span><i class="fas fa-trophy"></i> {{ top_players[2].wins }}</span>
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Top Players by Category -->
        <div class="row g-4">
            <!-- Experience Leaders -->
            <div class="col-lg-4 col-md-6">
                <div class="top-category-card experience-card">
                    <div class="card-header-gradient">
                        <div class="category-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h4 class="category-title">Опыт</h4>
                        <p class="category-subtitle">Самые опытные воины</p>
                    </div>
                    <div class="players-list">
                        {% set experience_leaders = top_players[:10] %}
                        {% for player in experience_leaders %}
                        <div class="player-item rank-{{ loop.index }}" data-rank="{{ loop.index }}">
                            <div class="player-rank">
                                {% if loop.index == 1 %}
                                    <div class="rank-crown">👑</div>
                                {% elif loop.index == 2 %}
                                    <div class="rank-medal silver">🥈</div>
                                {% elif loop.index == 3 %}
                                    <div class="rank-medal bronze">🥉</div>
                                {% else %}
                                    <div class="rank-number">#{{ loop.index }}</div>
                                {% endif %}
                            </div>

                            <div class="player-info">
                                <div class="player-name">
                                    <a href="{{ url_for('player_profile', player_id=player.id) }}" class="player-link">
                                        {% if player.leaderboard_use_gradient and player.can_use_leaderboard_gradients %}
                                        <span class="name-gradient {% if player.leaderboard_gradient_animated %}animated{% endif %}"
                                              style="background: linear-gradient(45deg, {{ player.leaderboard_gradient_start }}, {{ player.leaderboard_gradient_end }}); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                                            {{ player.nickname }}
                                        </span>
                                        {% else %}
                                        <span style="color: {{ player.leaderboard_name_color }};">{{ player.nickname }}</span>
                                        {% endif %}
                                    </a>
                                </div>
                                <div class="player-level">Уровень {{ player.level }}</div>
                            </div>

                            <div class="player-stat">
                                <div class="stat-value">{{ "{:,}".format(player.experience) }}</div>
                                <div class="stat-label">XP</div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Kill Leaders -->
            {% set kills_leaders = top_players | sort(attribute='kills', reverse=true) %}
            <div class="col-lg-4 col-md-6">
                <div class="top-category-card kills-card">
                    <div class="card-header-gradient">
                        <div class="category-icon">
                            <i class="fas fa-sword"></i>
                        </div>
                        <h4 class="category-title">Убийства</h4>
                        <p class="category-subtitle">Безжалостные убийцы</p>
                    </div>
                    <div class="players-list">
                        {% for player in kills_leaders[:10] %}
                        <div class="player-item rank-{{ loop.index }}" data-rank="{{ loop.index }}">
                            <div class="player-rank">
                                {% if loop.index == 1 %}
                                    <div class="rank-crown">👑</div>
                                {% elif loop.index == 2 %}
                                    <div class="rank-medal silver">🥈</div>
                                {% elif loop.index == 3 %}
                                    <div class="rank-medal bronze">🥉</div>
                                {% else %}
                                    <div class="rank-number">#{{ loop.index }}</div>
                                {% endif %}
                            </div>

                            <div class="player-info">
                                <div class="player-name">
                                    <a href="{{ url_for('player_profile', player_id=player.id) }}" class="player-link">
                                        {% if player.leaderboard_use_gradient and player.can_use_leaderboard_gradients %}
                                        <span class="name-gradient {% if player.leaderboard_gradient_animated %}animated{% endif %}"
                                              style="background: linear-gradient(45deg, {{ player.leaderboard_gradient_start }}, {{ player.leaderboard_gradient_end }}); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                                            {{ player.nickname }}
                                        </span>
                                        {% else %}
                                        <span style="color: {{ player.leaderboard_name_color }};">{{ player.nickname }}</span>
                                        {% endif %}
                                    </a>
                                </div>
                                <div class="player-stats-mini">K/D: {{ player.kd_ratio }}</div>
                            </div>

                            <div class="player-stat">
                                <div class="stat-value">{{ "{:,}".format(player.kills) }}</div>
                                <div class="stat-label">Убийств</div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Bed Breakers -->
            {% set beds_leaders = top_players | sort(attribute='beds_broken', reverse=true) %}
            <div class="col-lg-4 col-md-6">
                <div class="top-category-card beds-card">
                    <div class="card-header-gradient">
                        <div class="category-icon">
                            <i class="fas fa-bed"></i>
                        </div>
                        <h4 class="category-title">Кровати</h4>
                        <p class="category-subtitle">Разрушители снов</p>
                    </div>
                    <div class="players-list">
                        {% for player in beds_leaders[:10] %}
                        <div class="player-item rank-{{ loop.index }}" data-rank="{{ loop.index }}">
                            <div class="player-rank">
                                {% if loop.index == 1 %}
                                    <div class="rank-crown">👑</div>
                                {% elif loop.index == 2 %}
                                    <div class="rank-medal silver">🥈</div>
                                {% elif loop.index == 3 %}
                                    <div class="rank-medal bronze">🥉</div>
                                {% else %}
                                    <div class="rank-number">#{{ loop.index }}</div>
                                {% endif %}
                            </div>

                            <div class="player-info">
                                <div class="player-name">
                                    <a href="{{ url_for('player_profile', player_id=player.id) }}" class="player-link">
                                        {% if player.leaderboard_use_gradient and player.can_use_leaderboard_gradients %}
                                        <span class="name-gradient {% if player.leaderboard_gradient_animated %}animated{% endif %}"
                                              style="background: linear-gradient(45deg, {{ player.leaderboard_gradient_start }}, {{ player.leaderboard_gradient_end }}); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                                            {{ player.nickname }}
                                        </span>
                                        {% else %}
                                        <span style="color: {{ player.leaderboard_name_color }};">{{ player.nickname }}</span>
                                        {% endif %}
                                    </a>
                                </div>
                                <div class="player-stats-mini">Побед: {{ player.wins }}</div>
                            </div>

                            <div class="player-stat">
                                <div class="stat-value">{{ "{:,}".format(player.beds_broken) }}</div>
                                <div class="stat-label">Кроватей</div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <!-- New Section for Top 3 Players -->
        <div class="top-three-players-section text-center mb-5">
            <h2 class="section-title">
                <i class="fas fa-star text-warning me-3"></i>
                <span class="gradient-text">Топ 3 Игроков</span>
                <i class="fas fa-star text-warning ms-3"></i>
            </h2>
            <p class="section-subtitle">Лучшие из лучших</p>
            <div class="row g-4 justify-content-center mt-4">
                {% if top_players.top3 %}
                    {% for player in top_players.top3 %}
                    <div class="col-lg-3 col-md-4 col-sm-6">
                        <div class="top-player-card rank-{{ loop.index }}">
                            <div class="rank-badge-container">
                                <div class="rank-badge gold">#{{ loop.index }}</div>
                            </div>
                            <div class="top-player-avatar">
                                <img src="{{ url_for('static', filename='img/skins/' + player.uuid + '.png') }}" alt="Player Skin" class="player-skin">
                                <div class="avatar-glow"></div>
                            </div>
                            <div class="top-player-info">
                                <div class="player-name">
                                    <a href="{{ url_for('player_profile', player_id=player.id) }}" class="player-link">{{ player.nickname }}</a>
                                </div>
                                <div class="player-level">Уровень {{ player.level }}</div>
                            </div>
                            <div class="top-player-stats">
                                <div class="main-stat">
                                    <div class="stat-value">{{ "{:,}".format(player.total_xp) }}</div>
                                    <div class="stat-label">Опыт</div>
                                </div>
                                <div class="secondary-stats">
                                    <div class="stat-item"><i class="fas fa-user-friends"></i> {{ player.friends }}</div>
                                    <div class="stat-item"><i class="fas fa-gamepad"></i> {{ player.games_played }}</div>
                                </div>
                            </div>
                            <div class="top-player-actions">
                                <a href="{{ url_for('player_profile', player_id=player.id) }}" class="btn-profile">Профиль</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="col-12 text-center text-muted">
                        <p>Данные о топ-3 игроках пока недоступны.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    {% endif %}

    <!-- Navigation -->
    <div class="text-center mt-5">
        <a href="{{ url_for('index') }}" class="btn btn-primary btn-lg me-3">
            <i class="fas fa-arrow-left me-2"></i>Назад к таблице лидеров
        </a>
        {% if is_admin %}
        <a href="{{ url_for('admin') }}" class="btn btn-warning btn-lg">
            <i class="fas fa-cog me-2"></i>Панель администратора
        </a>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_head %}
<style>
/* Modern Statistics Page Styles */
.statistics-page {
    padding: 1rem 0;
}

.stats-header {
    background: linear-gradient(135deg, rgba(255,193,7,0.1), rgba(255,140,0,0.05));
    border-radius: 20px;
    margin-bottom: 2rem;
}

.section-title {
    color: #ffc107;
    font-weight: 700;
    margin-bottom: 1.5rem;
}

/* Modern Stat Cards */
.modern-stat-card {
    background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
    border: 1px solid rgba(255,193,7,0.2);
    border-radius: 20px;
    padding: 2rem 1.5rem;
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    backdrop-filter: blur(15px);
    height: 100%;
}

.modern-stat-card:hover {
    transform: translateY(-12px) scale(1.03);
    border-color: rgba(255,193,7,0.6);
    box-shadow: 0 20px 50px rgba(255,193,7,0.3);
}

.stat-icon-container {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 80px;
    height: 80px;
    margin: 0 auto 1.5rem;
}

.stat-icon-bg {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, rgba(255,193,7,0.2), rgba(255,140,0,0.2));
    border-radius: 50%;
    animation: pulse 2s ease-in-out infinite;
}

.stat-icon {
    font-size: 2.5rem;
    z-index: 2;
    filter: drop-shadow(0 0 10px rgba(255,193,7,0.5));
}

.stat-content {
    text-align: center;
}

.stat-value {
    font-size: 2.5rem;
    font-weight: 900;
    background: linear-gradient(45deg, #ffd700, #ffaa00, #ff6b35);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradientShift 3s ease-in-out infinite;
    margin-bottom: 0.5rem;
}

.stat-label {
    font-size: 1.1rem;
    color: #adb5bd;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.stat-change {
    font-size: 0.9rem;
    color: rgba(255,255,255,0.7);
    font-weight: 500;
}

.stat-wave {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, #ffd700, #ffaa00, #ff6b35);
    border-radius: 0 0 20px 20px;
    animation: waveMove 3s ease-in-out infinite;
}

/* Economic Stat Cards */
.economic-stat-card {
    background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
    border: 1px solid rgba(255,193,7,0.3);
    border-radius: 15px;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.economic-stat-card:hover {
    transform: translateY(-5px);
    border-color: rgba(255,193,7,0.6);
    box-shadow: 0 10px 30px rgba(255,193,7,0.2);
}

.economic-stat-card .stat-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
}

.economic-stat-card .stat-value {
    font-size: 2rem;
    font-weight: 800;
    color: #ffc107;
    margin-bottom: 0.5rem;
}

.economic-stat-card .stat-label {
    font-size: 0.9rem;
    color: rgba(255,255,255,0.8);
    margin-bottom: 1rem;
}

.stat-progress {
    height: 4px;
    background: rgba(255,255,255,0.1);
    border-radius: 2px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #ffc107, #fd7e14);
    border-radius: 2px;
    transition: width 1s ease-in-out;
}

/* Leader Cards */
.leader-card {
    background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
    border: 2px solid transparent;
    border-radius: 20px;
    padding: 2rem;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: all 0.4s ease;
    height: 100%;
}

.leader-card::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: 22px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.4s ease;
}

.richest-leader::before {
    background: linear-gradient(45deg, #ffd700, #ffaa00);
}

.reputable-leader::before {
    background: linear-gradient(45deg, #9400d3, #4b0082);
}

.leader-card:hover::before {
    opacity: 1;
}

.leader-card:hover {
    transform: translateY(-10px) scale(1.02);
}

.leader-bg {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, rgba(255,193,7,0.1), transparent);
    border-radius: 20px;
}

.leader-content {
    position: relative;
    z-index: 1;
}

.leader-icon {
    font-size: 3rem;
    color: #ffc107;
    margin-bottom: 1rem;
    filter: drop-shadow(0 0 15px rgba(255,193,7,0.5));
}

.leader-title {
    color: #ffc107;
    font-weight: 600;
    margin-bottom: 1rem;
}

.leader-name {
    font-size: 1.5rem;
    font-weight: 800;
    color: #fff;
    margin-bottom: 0.5rem;
}

.leader-value {
    font-size: 1.2rem;
    color: rgba(255,255,255,0.8);
}

/* Chart Cards */
.chart-card {
    background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
    border: 2px solid rgba(255,193,7,0.3);
    border-radius: 20px;
    padding: 1.5rem;
    height: 400px;
    transition: all 0.4s ease;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.chart-card:hover {
    transform: translateY(-8px);
    border-color: rgba(255,193,7,0.6);
    box-shadow: 0 15px 35px rgba(255,193,7,0.2);
}

.chart-header {
    margin-bottom: 1rem;
}

.chart-title {
    color: #fff;
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0;
}

.chart-container {
    height: calc(100% - 60px);
    position: relative;
}

/* Top Category Cards */
.top-category-card {
    background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(0,0,0,0.3));
    border: 1px solid rgba(255, 193, 7, 0.2);
    border-radius: 20px;
    padding: 0;
    height: 100%;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    backdrop-filter: blur(15px);
}

.top-category-card:hover {
    transform: translateY(-15px) scale(1.02);
    border-color: rgba(255, 193, 7, 0.6);
    box-shadow: 0 25px 50px rgba(255, 193, 7, 0.3);
}

.card-header-gradient {
    background: linear-gradient(135deg, rgba(255,193,7,0.8), rgba(255,140,0,0.6));
    padding: 2rem 1.5rem 1.5rem;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.category-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: rgba(0,0,0,0.8);
    filter: drop-shadow(0 0 10px rgba(255,255,255,0.3));
}

.category-title {
    font-size: 1.5rem;
    font-weight: 800;
    color: rgba(0,0,0,0.9);
    margin-bottom: 0.5rem;
}

.category-subtitle {
    font-size: 0.9rem;
    color: rgba(0,0,0,0.7);
    margin: 0;
    font-weight: 600;
}

.players-list {
    padding: 1.5rem;
}

.player-item {
    display: flex;
    align-items: center;
    padding: 1rem;
    margin-bottom: 1rem;
    background: linear-gradient(90deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
    border-radius: 15px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    border: 1px solid transparent;
}

.player-item:hover {
    transform: translateX(8px);
    background: linear-gradient(90deg, rgba(255,193,7,0.1), rgba(255,140,0,0.05));
    border-color: rgba(255, 193, 7, 0.3);
}

.player-rank {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    border-radius: 50%;
    font-weight: 900;
    font-size: 1.2rem;
    position: relative;
}

.rank-crown {
    font-size: 2rem;
    animation: bounce 2s ease-in-out infinite;
    filter: drop-shadow(0 0 10px rgba(255,215,0,0.8));
}

.rank-medal {
    font-size: 1.8rem;
    filter: drop-shadow(0 0 8px rgba(255,255,255,0.5));
}

.rank-number {
    background: rgba(255,255,255,0.1);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    font-weight: 700;
    color: rgba(255,255,255,0.8);
    border: 2px solid rgba(255,255,255,0.2);
}

.player-info {
    flex: 1;
    min-width: 0;
}

.player-name {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.3rem;
}

.player-link {
    text-decoration: none;
    color: #fff;
    transition: all 0.3s ease;
}

.player-link:hover {
    color: #ffd700;
    text-shadow: 0 0 10px rgba(255,215,0,0.6);
}

.name-gradient {
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    background-size: 200% 200%;
}

.name-gradient.animated {
    animation: gradientShift 3s ease-in-out infinite;
}

.player-level, .player-stats-mini {
    font-size: 0.85rem;
    color: rgba(255,255,255,0.6);
    font-weight: 500;
}

.player-stat {
    text-align: right;
    min-width: 80px;
}

.player-stat .stat-value {
    font-size: 1.3rem;
    font-weight: 900;
    color: #ffd700;
    line-height: 1.2;
    text-shadow: 0 0 10px rgba(255,215,0,0.4);
    margin-bottom: 0;
}

.player-stat .stat-label {
    font-size: 0.8rem;
    color: rgba(255,255,255,0.6);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Category-specific colors */
.experience-card .card-header-gradient {
    background: linear-gradient(135deg, rgba(255,193,7,0.9), rgba(255,140,0,0.7));
}

.kills-card .card-header-gradient {
    background: linear-gradient(135deg, rgba(220,53,69,0.9), rgba(255,107,53,0.7));
}

.beds-card .card-header-gradient {
    background: linear-gradient(135deg, rgba(23,162,184,0.9), rgba(32,201,151,0.7));
}

.wins-card .card-header-gradient {
    background: linear-gradient(135deg, rgba(40,167,69,0.9), rgba(32,201,151,0.7));
}

.final-kills-card .card-header-gradient {
    background: linear-gradient(135deg, rgba(108,117,125,0.9), rgba(173,181,189,0.7));
}

/* Animations */
@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 0.7; }
    50% { transform: scale(1.1); opacity: 1; }
}

@keyframes waveMove {
    0%, 100% { transform: scaleX(0.8); opacity: 0.5; }
    50% { transform: scaleX(1.2); opacity: 1; }
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
}

/* Top 3 Players Cards Styles */
.top-players-podium {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 20px;
    margin-bottom: 3rem;
    flex-wrap: wrap;
}

.podium-place {
    text-align: center;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
    border: 2px solid rgba(255,193,7,0.3);
    border-radius: 25px;
    padding: 15px;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    backdrop-filter: blur(15px);
}

.podium-place:hover {
    transform: translateY(-15px) scale(1.03);
    border-color: rgba(255,193,7,0.8);
    box-shadow: 0 25px 50px rgba(255,193,7,0.4);
}

.podium-place .place-number {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(45deg, #007bff, #0056b3);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-weight: bold;
    font-size: 1rem;
    box-shadow: 0 5px 15px rgba(0,123,255,0.3);
}

.podium-place .crown-icon {
    font-size: 2.5rem;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 15px rgba(255,215,0,0.6));
}

.podium-place .player-avatar {
    position: relative;
    width: 100px;
    height: 100px;
    margin-bottom: 10px;
}

.podium-place .player-skin {
    width: 100%;
    height: 100%;
    border-radius: 15px;
    image-rendering: pixelated;
    border: 3px solid rgba(255,193,7,0.3);
    transition: all 0.3s ease;
}

.podium-place:hover .player-skin {
    transform: scale(1.1);
    border-color: rgba(255,193,7,0.8);
}

.avatar-glow {
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    border-radius: 20px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.podium-place:hover .avatar-glow {
    opacity: 1;
}

.gold-glow { background: radial-gradient(circle, rgba(255,215,0,0.3), transparent); }
.silver-glow { background: radial-gradient(circle, rgba(192,192,192,0.3), transparent); }
.bronze-glow { background: radial-gradient(circle, rgba(205,127,50,0.3), transparent); }

.podium-place .player-name {
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #fff;
}

.podium-place .player-level {
    font-size: 0.9rem;
    color: rgba(255,255,255,0.7);
    margin-bottom: 10px;
}

.experience-badge {
    font-weight: bold;
    padding: 5px 12px;
    border-radius: 15px;
    font-size: 0.85rem;
    margin-bottom: 10px;
}
.experience-badge.gold { background-color: rgba(255,215,0,0.2); color: #ffd700; border: 1px solid rgba(255,215,0,0.5); }
.experience-badge.silver { background-color: rgba(192,192,192,0.2); color: #c0c0c0; border: 1px solid rgba(192,192,192,0.5); }
.experience-badge.bronze { background-color: rgba(205,127,50,0.2); color: #cd7f32; border: 1px solid rgba(205,127,50,0.5); }

.stats-mini {
    font-size: 0.8rem;
    color: rgba(255,255,255,0.7);
    display: flex;
    gap: 15px;
}

.stats-mini i {
    margin-right: 5px;
    color: rgba(255,255,255,0.8);
}

/* Podium Specific Styling */
.podium-first {
    width: 180px;
    height: 280px;
    order: 2;
}
.podium-first .place-number { background: linear-gradient(45deg, #FFD700, #FFA500); }
.podium-first .player-avatar { width: 120px; height: 120px; margin-top: -40px; z-index: 1; }

.podium-second {
    width: 160px;
    height: 240px;
    order: 1;
}
.podium-second .place-number { background: linear-gradient(45deg, #C0C0C0, #E5E5E5); }
.podium-second .player-avatar { width: 100px; height: 100px; margin-top: -20px; }

.podium-third {
    width: 140px;
    height: 200px;
    order: 3;
}
.podium-third .place-number { background: linear-gradient(45deg, #CD7F32, #D4944A); }
.podium-third .player-avatar { width: 90px; height: 90px; }

/* Responsive adjustments for podium */
@media (max-width: 992px) {
    .top-players-podium {
        flex-wrap: wrap;
        justify-content: center;
    }
    .podium-place {
        width: 150px;
        height: 220px;
        margin: 10px;
    }
    .podium-first { height: 250px; }
    .podium-first .player-avatar { width: 110px; height: 110px; margin-top: -30px; }
    .podium-second { height: 210px; }
    .podium-second .player-avatar { width: 90px; height: 90px; margin-top: -15px; }
    .podium-third { height: 180px; }
    .podium-third .player-avatar { width: 80px; height: 80px; }
}

@media (max-width: 768px) {
    .podium-place {
        width: 120px;
        height: 180px;
    }
    .podium-first { height: 200px; }
    .podium-first .player-avatar { width: 90px; height: 90px; margin-top: -20px; }
    .podium-second { height: 160px; }
    .podium-second .player-avatar { width: 80px; height: 80px; margin-top: -10px; }
    .podium-third { height: 140px; }
    .podium-third .player-avatar { width: 70px; height: 70px; }
    .stats-mini { font-size: 0.7rem; }
}

/* Animations */
@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 0.7; }
    50% { transform: scale(1.1); opacity: 1; }
}

@keyframes waveMove {
    0%, 100% { transform: scaleX(0.8); opacity: 0.5; }
    50% { transform: scaleX(1.2); opacity: 1; }
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
}

/* Top 3 Players Cards Styles */
.top-three-players-section {
    margin-bottom: 3rem;
}

.top-player-card {
    background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
    border: 2px solid rgba(255,193,7,0.3);
    border-radius: 25px;
    padding: 2rem;
    text-align: center;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    overflow: hidden;
    backdrop-filter: blur(15px);
    height: 100%;
}

.top-player-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 50% 0%, rgba(255,193,7,0.1), transparent 70%);
    opacity: 0;
    transition: opacity 0.4s ease;
    pointer-events: none;
}

.top-player-card:hover {
    transform: translateY(-15px) scale(1.03);
    border-color: rgba(255,193,7,0.8);
    box-shadow: 0 25px 50px rgba(255,193,7,0.4);
}

.top-player-card:hover::before {
    opacity: 1;
}

/* Special styling for different ranks */
.top-player-card.rank-1 {
    border-color: rgba(255,215,0,0.6);
    background: linear-gradient(145deg, rgba(255,215,0,0.15), rgba(255,255,255,0.02));
}

.top-player-card.rank-1:hover {
    border-color: rgba(255,215,0,0.9);
    box-shadow: 0 25px 50px rgba(255,215,0,0.5);
}

.top-player-card.rank-2 {
    border-color: rgba(192,192,192,0.6);
    background: linear-gradient(145deg, rgba(192,192,192,0.15), rgba(255,255,255,0.02));
}

.top-player-card.rank-2:hover {
    border-color: rgba(192,192,192,0.9);
    box-shadow: 0 25px 50px rgba(192,192,192,0.4);
}

.top-player-card.rank-3 {
    border-color: rgba(205,127,50,0.6);
    background: linear-gradient(145deg, rgba(205,127,50,0.15), rgba(255,255,255,0.02));
}

.top-player-card.rank-3:hover {
    border-color: rgba(205,127,50,0.9);
    box-shadow: 0 25px 50px rgba(205,127,50,0.4);
}

.rank-badge-container {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2;
}

.rank-badge {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    font-weight: bold;
    font-size: 0.9rem;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.rank-badge::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: badgeShine 3s ease-in-out infinite;
}

.rank-badge.gold {
    background: linear-gradient(45deg, #ffd700, #ffed4a);
    color: #333;
    border: 2px solid #ffd700;
}

.rank-badge.silver {
    background: linear-gradient(45deg, #c0c0c0, #e5e5e5);
    color: #333;
    border: 2px solid #c0c0c0;
}

.rank-badge.bronze {
    background: linear-gradient(45deg, #cd7f32, #d4944a);
    color: #fff;
    border: 2px solid #cd7f32;
}

.top-player-avatar {
    position: relative;
    margin: 2rem auto 1.5rem;
    width: 100px;
    height: 100px;
}

.player-skin {
    width: 100%;
    height: 100%;
    border-radius: 15px;
    image-rendering: pixelated;
    border: 3px solid rgba(255,193,7,0.3);
    transition: all 0.3s ease;
}

.top-player-card:hover .player-skin {
    transform: scale(1.1);
    border-color: rgba(255,193,7,0.8);
}

.avatar-glow {
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    background: radial-gradient(circle, rgba(255,193,7,0.3), transparent);
    border-radius: 20px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.top-player-card:hover .avatar-glow {
    opacity: 1;
}

.top-player-info {
    margin-bottom: 1.5rem;
}

.top-player-info .player-name {
    font-size: 1.3rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.top-player-info .player-name .player-link {
    text-decoration: none;
    color: #fff;
    transition: all 0.3s ease;
}

.top-player-info .player-name .player-link:hover {
    color: #ffd700;
    text-shadow: 0 0 15px rgba(255,215,0,0.6);
}

.top-player-info .player-level {
    font-size: 0.95rem;
    color: rgba(255,255,255,0.7);
    font-weight: 500;
}

.top-player-stats {
    margin-bottom: 1.5rem;
}

.main-stat {
    margin-bottom: 1rem;
}

.main-stat .stat-value {
    font-size: 2.2rem;
    font-weight: 900;
    color: #ffd700;
    text-shadow: 0 0 15px rgba(255,215,0,0.5);
    margin-bottom: 0.25rem;
}

.main-stat .stat-label {
    font-size: 0.95rem;
    color: rgba(255,255,255,0.8);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
}

.secondary-stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 1rem;
}

.secondary-stats .stat-item {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    font-size: 0.9rem;
    color: rgba(255,255,255,0.8);
    font-weight: 600;
}

.secondary-stats .stat-item i {
    font-size: 1rem;
}

.star-rating {
    display: flex;
    justify-content: center;
    gap: 0.25rem;
    margin-bottom: 1rem;
}

.star-rating .fa-star {
    font-size: 1.1rem;
    transition: all 0.3s ease;
}

.star-filled {
    color: #ffd700;
    text-shadow: 0 0 10px rgba(255,215,0,0.6);
}

.star-empty {
    color: rgba(255,255,255,0.3);
}

.top-player-card:hover .star-rating .fa-star {
    transform: scale(1.1);
}

.top-player-actions {
    margin-top: auto;
}

.btn-profile {
    background: linear-gradient(45deg, #007bff, #0056b3);
    border: none;
    border-radius: 25px;
    padding: 0.75rem 2rem;
    font-weight: bold;
    transition: all 0.3s ease;
    text-decoration: none;
    color: white;
    box-shadow: 0 4px 15px rgba(0,123,255,0.3);
}

.btn-profile:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,123,255,0.5);
    background: linear-gradient(45deg, #0056b3, #003d82);
    color: white;
}

@keyframes badgeShine {
    0% { left: -100%; }
    50%, 100% { left: 100%; }
}

/* Mobile responsiveness for top player cards */
@media (max-width: 768px) {
    .top-player-card {
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .rank-badge {
        padding: 0.5rem 1rem;
        font-size: 0.8rem;
    }

    .top-player-avatar {
        width: 80px;
        height: 80px;
        margin: 1.5rem auto 1rem;
    }

    .main-stat .stat-value {
        font-size: 1.8rem;
    }

    .secondary-stats {
        flex-direction: column;
        gap: 0.5rem;
        align-items: center;
    }

    .btn-profile {
        padding: 0.6rem 1.5rem;
        font-size: 0.9rem;
    }
}

/* Mobile responsiveness for social links */
</style>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Enhanced statistics with animations
document.addEventListener('DOMContentLoaded', function() {
    // Animate stat cards
    animateStatCards();

    // Load and display charts
    loadStatisticsData();

    // Add interactive hover effects
    addInteractiveEffects();
});

function animateStatCards() {
    const statBoxes = document.querySelectorAll('.modern-stat-card, .economic-stat-card');
    statBoxes.forEach((box, index) => {
        setTimeout(() => {
            box.style.animation = 'fadeInUp 0.8s ease forwards';

            // Animate numbers
            const valueElement = box.querySelector('.stat-value');
            if (valueElement) {
                const finalValue = valueElement.textContent.replace(/[^0-9]/g, '');
                if (finalValue) {
                    animateCounter(valueElement, 0, parseInt(finalValue), 2000);
                }
            }
        }, index * 150);
    });
}

function animateCounter(element, start, end, duration) {
    const startTime = performance.now();
    const originalText = element.textContent;

    function updateCounter(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);

        const easeOut = 1 - Math.pow(1 - progress, 3);
        const currentValue = Math.floor(start + (end - start) * easeOut);

        // Preserve formatting
        if (originalText.includes(',')) {
            element.textContent = currentValue.toLocaleString();
        } else {
            element.textContent = currentValue.toLocaleString();
        }

        if (progress < 1) {
            requestAnimationFrame(updateCounter);
        }
    }

    requestAnimationFrame(updateCounter);
}

function loadStatisticsData() {
    fetch('/api/stats')
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                console.error('Error loading statistics:', data.error);
                return;
            }
            createEnhancedCharts(data.charts);
        })
        .catch(error => {
            console.error('Error:', error);
        });
}

function addInteractiveEffects() {
    // Add glow effect to stat boxes on hover
    document.querySelectorAll('.modern-stat-card, .economic-stat-card').forEach(box => {
        box.addEventListener('mouseenter', function() {
            this.style.boxShadow = '0 0 30px rgba(255, 193, 7, 0.4)';
        });

        box.addEventListener('mouseleave', function() {
            this.style.boxShadow = '';
        });
    });
}

function createEnhancedCharts(chartData) {
    // Common chart options for consistent styling
    const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
        animation: {
            duration: 2000,
            easing: 'easeInOutQuart'
        },
        plugins: {
            legend: {
                labels: {
                    color: '#fff',
                    font: {
                        size: 14,
                        weight: 'bold'
                    }
                }
            },
            tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                titleColor: '#ffc107',
                bodyColor: '#fff',
                borderColor: '#ffc107',
                borderWidth: 1
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    color: '#adb5bd',
                    font: { size: 12 }
                },
                grid: {
                    color: 'rgba(255, 255, 255, 0.1)',
                    drawBorder: false
                }
            },
            x: {
                ticks: {
                    color: '#adb5bd',
                    font: { size: 12 }
                },
                grid: {
                    color: 'rgba(255, 255, 255, 0.1)',
                    drawBorder: false
                }
            }
        }
    };

    // Experience Chart
    if (chartData && chartData.top_players_exp) {
        const expCtx = document.getElementById('experienceChart');
        if (expCtx) {
            const expGradient = expCtx.getContext('2d').createLinearGradient(0, 0, 0, 400);
            expGradient.addColorStop(0, 'rgba(255, 193, 7, 0.8)');
            expGradient.addColorStop(1, 'rgba(255, 193, 7, 0.2)');

            new Chart(expCtx, {
                type: 'bar',
                data: {
                    labels: chartData.top_players_exp.labels,
                    datasets: [{
                        label: 'Опыт',
                        data: chartData.top_players_exp.data,
                        backgroundColor: expGradient,
                        borderColor: '#ffc107',
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: commonOptions
            });
        }
    }

    // Kills Chart
    if (chartData && chartData.top_players_kills) {
        const killsCtx = document.getElementById('killsChart');
        if (killsCtx) {
            new Chart(killsCtx, {
                type: 'bar',
                data: {
                    labels: chartData.top_players_kills.labels,
                    datasets: [{
                        label: 'Убийства',
                        data: chartData.top_players_kills.data,
                        backgroundColor: 'rgba(220, 53, 69, 0.8)',
                        borderColor: 'rgba(220, 53, 69, 1)',
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: commonOptions
            });
        }
    }

    // Levels Distribution Chart
    if (chartData && chartData.player_levels) {
        const levelsCtx = document.getElementById('levelsChart');
        if (levelsCtx) {
            const levelLabels = Object.keys(chartData.player_levels);
            const levelData = Object.values(chartData.player_levels);

            new Chart(levelsCtx, {
                type: 'doughnut',
                data: {
                    labels: levelLabels,
                    datasets: [{
                        data: levelData,
                        backgroundColor: [
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(40, 167, 69, 0.8)',
                            'rgba(23, 162, 184, 0.8)',
                            'rgba(220, 53, 69, 0.8)',
                            'rgba(108, 117, 125, 0.8)',
                            'rgba(102, 16, 242, 0.8)'
                        ],
                        borderWidth: 2,
                        borderColor: '#343a40'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#fff' }
                        }
                    }
                }
            });
        }
    }

    // Performance Comparison Chart
    if (chartData && chartData.top_players_exp && chartData.top_players_kills) {
        const perfCtx = document.getElementById('performanceChart');
        if (perfCtx) {
            new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: chartData.top_players_exp.labels.slice(0, 5),
                    datasets: [
                        {
                            label: 'Опыт (÷100)',
                            data: chartData.top_players_exp.data.slice(0, 5).map(x => x / 100),
                            borderColor: 'rgba(255, 193, 7, 1)',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Убийства',
                            data: chartData.top_players_kills.data.slice(0, 5),
                            borderColor: 'rgba(220, 53, 69, 1)',
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: commonOptions
            });
        }
    }
}

// Animate elements on scroll
const animateOnScroll = () => {
    const elements = document.querySelectorAll('.modern-stat-card, .chart-card, .top-category-card, .top-player-card, .podium-place');
    elements.forEach((element, index) => {
        const elementTop = element.getBoundingClientRect().top;
        const elementVisible = 150;

        if (elementTop < window.innerHeight - elementVisible) {
            setTimeout(() => {
                element.style.animation = 'fadeInUp 0.6s ease forwards';
            }, index * 100);
        }
    });
};

window.addEventListener('scroll', animateOnScroll);

// Initial animation
setTimeout(animateOnScroll, 100);
</script>
{% endblock %}